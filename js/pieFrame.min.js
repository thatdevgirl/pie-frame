"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var a=0,r=Array(t.length);a<t.length;a++)r[a]=t[a];return r}return Array.from(t)}var pieFrame={apiKey:"AIzaSyDwOQMIN3mLy9xyaiWrYJz1jZbozHB81Co",create:function(){var t=this,a=$("chart"),r=!0,e=!1,i=void 0;try{for(var n,h=a[Symbol.iterator]();!(r=(n=h.next()).done);r=!0)!function(){var a=n.value,r=t.getChartInfo(a),e=t.getSheetUrl(r.id);$.ajax(e,{success:function(a){r.data=t.processData(a),r.colors=t.generateColors(r),t.displayChart(r)},error:function(t){return console.log(t),!1}})}()}catch(t){e=!0,i=t}finally{try{!r&&h.return&&h.return()}finally{if(e)throw i}}},getChartInfo:function(t){var a={id:$(t).attr("data-id"),type:$(t).attr("data-type"),colorseed:$(t).attr("data-colorseed"),hue:$(t).attr("data-hue"),desc:$(t).html()},r=Math.floor(1e3*Math.random())+"";return $(t).replaceWith($('<div class="chart" data-id="'+a.id+'" id="chart-'+r+'"></div>')),a.el=$("div#chart-"+r)[0],a},getSheetUrl:function(t){return"https://sheets.googleapis.com/v4/spreadsheets/"+t+"/values/A2%3AZ1000/?key="+this.apiKey},processData:function(t){var a=[],r=[],e=!0,i=!1,n=void 0;try{for(var h,c=t.values[Symbol.iterator]();!(e=(h=c.next()).done);e=!0){var o=h.value;a.push(o[0]),r.push(o[1])}}catch(t){i=!0,n=t}finally{try{!e&&c.return&&c.return()}finally{if(i)throw n}}return{labels:a,counts:r}},generateColors:function(t){var a={count:t.data.counts.length};return t.colorseed&&(a.seed=t.colorseed),t.hue&&(a.hue=t.hue),"horizontal-bar"!=t.type&&"vertical-bar"!=t.type||(a.luminosity="dark"),randomColor(a)},displayChart:function(t){switch(t.type){case"horizontal-bar":pfBarChart.display(t,"horizontal");break;case"vertical-bar":pfBarChart.display(t,"vertical");break;case"pie":pfPieChart.display(t)}}};$(document).ready(function(){pieFrame.create()});var pfBarChart={config:{barThickness:40,barGutter:8,labelWidth:120,labelHeight:50,labelBaseline:20,labelColor:"black",countColor:"white",chartHeight:500},display:function(t,a){switch(this.chart=t,this.orientation=a,this.getSvgDimensions(),this.createSvg(),this.orientation){case"horizontal":pfHorizonal.create();break;case"vertical":pfVertical.create()}},createSvg:function(){this.svg=d3.select(this.chart.el).append("svg").attr("width","100%").attr("height",this.height),this.chart.desc&&this.svg.append("desc").text(this.chart.desc)},createBase:function(){var t=this,a=this.svg.selectAll("g").data(this.chart.data.counts).enter().append("g");return a.append("title").text(function(a,r){return"Data for "+t.chart.data.labels[r]}),a.append("desc").text(function(a,r){return"The number of "+t.chart.data.labels[r]+" is "+a+", which is "+t.getBarSize(a)+"% of the total."}),a},getSvgDimensions:function(){this.maxSize=Math.max.apply(Math,_toConsumableArray(this.chart.data.counts)),"horizontal"==this.orientation?this.height=this.chart.data.counts.length*(this.config.barThickness+this.config.barGutter):"vertical"==this.orientation&&(this.height=this.config.chartHeight)},getBarSize:function(t){return this.maxSize?t/this.maxSize*100:0}},pfHorizonal={create:function(){var t=this,a=pfBarChart.createBase();return a.append("rect").attr("height",pfBarChart.config.barThickness).attr("width",function(t){return pfBarChart.getBarSize(t)+"%"}).attr("x",pfBarChart.config.labelWidth).attr("y",function(a,r){return t.barY(r)}).attr("fill",function(t,a){return pfBarChart.chart.colors[a]}),a.append("text").text(function(t,a){return pfBarChart.chart.data.labels[a]}).attr("height",pfBarChart.config.barThickness).attr("y",function(a,r){return t.barY(r,pfBarChart.config.labelBaseline)}).attr("fill",pfBarChart.config.labelColor),a.append("text").text(function(t){return t}).attr("height",pfBarChart.config.barThickness).attr("x",pfBarChart.config.labelWidth+pfBarChart.config.barGutter).attr("y",function(a,r){return t.barY(r,pfBarChart.config.labelBaseline)}).attr("fill",pfBarChart.config.countColor),a},barY:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-7;return t*pfBarChart.config.barThickness+t*pfBarChart.config.barGutter+a}},pfVertical={create:function(){var t=this,a=pfBarChart.createBase(),r=d3.scaleLinear().range([pfBarChart.config.chartHeight-pfBarChart.config.labelHeight,0]);return a.attr("transform","translate(40,10)"),a.call(d3.axisLeft(r)),a.append("rect").attr("height",function(a){return t.barHeight(a)+"px"}).attr("width",function(){return t.barWidth()+"%"}).attr("x",function(a,r){return t.barX(r)+"%"}).attr("y",function(a){return t.barY(a)}).attr("fill",function(t,a){return pfBarChart.chart.colors[a]}),a.append("text").text(function(t,a){return pfBarChart.chart.data.labels[a]}).attr("height",pfBarChart.config.barThickness).attr("transform","translate(60,0)").attr("x",function(a,r){return t.barX(r)+"%"}).attr("y",pfBarChart.config.chartHeight-pfBarChart.config.labelHeight/2).attr("fill",pfBarChart.config.labelColor),a},barHeight:function(t){return pfBarChart.getBarSize(t)/100*(pfBarChart.config.chartHeight-pfBarChart.config.labelHeight)},barWidth:function(){return(100-pfBarChart.chart.data.counts.length)/pfBarChart.chart.data.counts.length},barY:function(t){var a=this.barHeight(t);return pfBarChart.config.chartHeight-pfBarChart.config.labelHeight-a},barX:function(t){return t*(this.barWidth()+1)}},pfPieChart={config:{size:500,radius:250},display:function(t){this.chart=t,this.createSvg(),this.createPie(),this.createLabels()},createSvg:function(){this.svg=d3.select(this.chart.el).append("svg").attr("width",this.config.size).attr("height",this.config.size),this.chart.desc&&this.svg.append("desc").text(this.chart.desc)},createPie:function(){var t=this,a=d3.arc().innerRadius(0).outerRadius(this.config.radius),r=d3.pie().value(function(t){return t}).sort(null);this.svg.append("g").attr("transform","translate("+this.config.radius+","+this.config.radius+")").selectAll("path").data(r(this.chart.data.counts)).enter().append("path").attr("d",a).attr("fill",function(a){return t.chart.colors[a.index]})},createLabels:function(){for(var t="",a=this.chart.data.counts.reduce(function(t,a){return t+parseInt(a)},0),r=0;r<this.chart.data.labels.length;r++)t+='<p>\n                 <span class="legend" style="background: '+this.chart.colors[r]+'"></span>\n                 '+this.chart.data.labels[r]+" ("+Math.round(this.chart.data.counts[r]/a*100)+"%)\n               </p>";$(this.chart.el).append(t)}};