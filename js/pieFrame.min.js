"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var a=0,e=Array(t.length);a<t.length;a++)e[a]=t[a];return e}return Array.from(t)}var pieFrame={apiKey:"AIzaSyDwOQMIN3mLy9xyaiWrYJz1jZbozHB81Co",create:function(){var t=this,a=$("chart"),e=!0,r=!1,i=void 0;try{for(var n,s=a[Symbol.iterator]();!(e=(n=s.next()).done);e=!0)!function(){var a=n.value,e=t.getChartInfo(a),r=t.getSheetUrl(e.id);$.ajax(r,{success:function(a){e.data=t.processData(a),e.colors=t.generateColors(e),t.displayChart(e)},error:function(t){return console.log(t),!1}})}()}catch(t){r=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(r)throw i}}},getChartInfo:function(t){var a={id:$(t).attr("data-id"),type:$(t).attr("data-type"),colorseed:$(t).attr("data-colorseed"),hue:$(t).attr("data-hue"),desc:$(t).html()},e=Math.floor(1e3*Math.random())+"";return $(t).replaceWith($('<div class="chart" data-id="'+a.id+'" id="chart-'+e+'"></div>')),a.el=$("div#chart-"+e)[0],a},getSheetUrl:function(t){return"https://sheets.googleapis.com/v4/spreadsheets/"+t+"/values/A2%3AZ1000/?key="+this.apiKey},processData:function(t){var a=[],e=[],r=!0,i=!1,n=void 0;try{for(var s,h=t.values[Symbol.iterator]();!(r=(s=h.next()).done);r=!0){var o=s.value;a.push(o[0]),e.push(o[1])}}catch(t){i=!0,n=t}finally{try{!r&&h.return&&h.return()}finally{if(i)throw n}}return{labels:a,counts:e}},generateColors:function(t){var a=t.data.counts.length,e={count:a};return t.colorseed&&(e.seed=t.colorseed),t.hue&&(e.hue=t.hue),randomColor(e)},displayChart:function(t){switch(t.type){case"horizontal-bar":pfBarChart.display(t,"horizontal");break;case"vertical-bar":pfBarChart.display(t,"vertical");break;case"pie":pfPieChart.display(t)}}};$(document).ready(function(){pieFrame.create()});var pfBarChart={config:{barThickness:40,barGutter:8,labelWidth:120,labelHeight:100,labelBaseline:20,labelColor:"black"},display:function(t,a){switch(this.chart=t,this.orientation=a,this.getSvgDimensions(),this.createSvg(),this.orientation){case"horizontal":this.createHorizontalChart();break;case"vertical":this.createVerticalChart()}},createSvg:function(){switch(this.orientation){case"horizontal":this.svg=d3.select(this.chart.el).append("svg").attr("width","100%").attr("height",this.height)}this.chart.desc&&this.svg.append("desc").text(this.chart.desc)},createHorizontalChart:function(){var t=this,a=this.svg.selectAll("g").data(this.chart.data.counts).enter().append("g");return a.append("title").text(function(a,e){return"Data for "+t.chart.data.labels[e]}),a.append("desc").text(function(a,e){return"The number of "+t.chart.data.labels[e]+" is "+a+", which is "+t.getBarSize(a)+"% of the total."}),a.append("rect").attr("height",this.config.barThickness).attr("width",function(a){return t.getBarSize(a)+"%"}).attr("x",this.config.labelWidth).attr("y",function(a,e){return t.getBarLocation(e)}).attr("fill",function(a,e){return t.chart.colors[e]}),a.append("text").text(function(a,e){return t.chart.data.labels[e]}).attr("height",this.config.barThickness).attr("y",function(a,e){return t.getBarLocation(e,t.config.labelBaseline)}).attr("fill",this.config.labelColor),a.append("text").text(function(t){return t}).attr("height",this.config.barThickness).attr("x",this.config.labelWidth+this.config.barGutter).attr("y",function(a,e){return t.getBarLocation(e,t.config.labelBaseline)}).attr("fill",this.config.labelColor),a},createVerticalChart:function(){return!1},getSvgDimensions:function(){"horizontal"==this.orientation?(this.width=Math.max.apply(Math,_toConsumableArray(this.chart.data.counts)),this.height=this.chart.data.counts.length*(this.config.barThickness+this.config.barGutter)):this.orientation},getBarSize:function(t){return this.width?t/this.width*100:0},getBarLocation:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-7;return t*this.config.barThickness+t*this.config.barGutter+a},getVerticalBarBase:function(t){return this.height-this.getBarSize(t)/100*this.height+this.labelHeight}},pfPieChart={config:{size:500,radius:250},display:function(t){this.chart=t,this.createSvg(),this.createPie(),this.createLabels()},createSvg:function(){this.svg=d3.select(this.chart.el).append("svg").attr("width",this.config.size).attr("height",this.config.size),this.chart.desc&&this.svg.append("desc").text(this.chart.desc)},createPie:function(){var t=this,a=d3.arc().innerRadius(0).outerRadius(this.config.radius),e=d3.pie().value(function(t){return t}).sort(null);this.svg.append("g").attr("transform","translate("+this.config.radius+","+this.config.radius+")").selectAll("path").data(e(this.chart.data.counts)).enter().append("path").attr("d",a).attr("fill",function(a){return t.chart.colors[a.index]})},createLabels:function(){for(var t="",a=this.chart.data.counts.reduce(function(t,a){return t+parseInt(a)},0),e=0;e<this.chart.data.labels.length;e++){t+='<p>\n                 <span class="legend" style="background: '+this.chart.colors[e]+'"></span>\n                 '+this.chart.data.labels[e]+" ("+Math.round(this.chart.data.counts[e]/a*100)+"%)\n               </p>"}$(this.chart.el).append(t)}};